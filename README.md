# ETL-–ø—Ä–æ–µ–∫—Ç –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä—ë—Ö –∑–∞–¥–∞—á, —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö –ø–æ–ª–Ω—ã–π ETL-–ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL.

---

## 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL  
–ü–∞–ø–∫–∞: `–ó–∞–¥–∞—á–∞ 1.1`  
–°–∫—Ä–∏–ø—Ç: `1-1-etl.py`  
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: `presentation1-1.mp4`

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç CSV-—Ñ–∞–π–ª—ã –≤ —Ç–∞–±–ª–∏—Ü—ã —Å—Ö–µ–º—ã `DS`.

### –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∫ –±–∞–∑–µ –ª–æ–≥–æ–≤.
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –∏–º–µ–Ω–∏ CSV-—Ñ–∞–π–ª–∞.
- –ß—Ç–µ–Ω–∏–µ CSV —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫ (`utf-8`, `ISO-8859-1`).
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –¥–∞—Ç–∞–º–∏.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π.
- –ü–∞–∫–µ—Ç–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `ON CONFLICT DO UPDATE`.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É `logs.etl_log`.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ CSV –∏–∑ –ø–∞–ø–∫–∏ `csv_files/` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ë–î.

---

## 2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω—ã –æ–±–æ—Ä–æ—Ç–æ–≤ –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤  
–ü–∞–ø–∫–∞: `–ó–∞–¥–∞—á–∞ 1.2`  
–°–∫—Ä–∏–ø—Ç: `1-2.sql`  
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: `presentation1-2.mp4`

–°–∫—Ä–∏–ø—Ç –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º –Ω–∞ –∑–∞–¥–∞–Ω–Ω—É—é –¥–∞—Ç—É, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—è –æ–±–æ—Ä–æ—Ç—ã –∏ –æ—Å—Ç–∞—Ç–∫–∏ –≤ –≤–∞–ª—é—Ç–µ —Å—á—ë—Ç–∞ –∏ –≤ —Ä—É–±–ª—è—Ö.  
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `DM.DM_ACCOUNT_TURNOVER_F`.

---

## 3. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞ 101  
–ü–∞–ø–∫–∞: `–ó–∞–¥–∞—á–∞ 1.3`  
–°–∫—Ä–∏–ø—Ç: `1-3.sql`  
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: `presentation1-3.mp4`

–§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤–∏—Ç—Ä–∏–Ω–∞ `DM.dm_f101_round_f`, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è:
- –û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞;
- –î–µ–±–µ—Ç–æ–≤—ã–µ –∏ –∫—Ä–µ–¥–∏—Ç–æ–≤—ã–µ –æ–±–æ—Ä–æ—Ç—ã;
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ –≥–ª–∞–≤–∞–º, –±–∞–ª–∞–Ω—Å–æ–≤—ã–º —Å—á–µ—Ç–∞–º –∏ —Ç–∏–ø–∞–º —Å—á–µ—Ç–æ–≤.

–î–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á—ë—Ç–∞ **—Ñ–æ—Ä–º—ã 101**.

---

## 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á—ë—Ç–∞ 101  
–ü–∞–ø–∫–∞: `–ó–∞–¥–∞—á–∞ 1.4`  
–°–∫—Ä–∏–ø—Ç: `1-4.py`  
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: `presentation1-3.mp4`

Python-—Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–∞—Å—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É `dm.dm_f101_round_f`. –í—Å–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –ª–æ–≥–æ–≤ `logs.etl_log`.

---

## –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∑–∞–ø—É—Å–∫

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `docker-compose` —Å PostgreSQL 15 (–ø–æ—Ä—Ç `5432`).
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –∏ —Å—Ö–µ–º—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `sql.sql`.
- –¢–∞–±–ª–∏—Ü—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`etl_user`, `logger_user`) —Ç–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —ç—Ç–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º.

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
docker-compose up -d
psql -U test -h localhost -f sql.sql

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Python** (`pandas`, `psycopg2`, `SQLAlchemy`)
- **PostgreSQL**
- **CSV**
- **Docker Compose**

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 1.1
‚îÇ ‚îú‚îÄ‚îÄ 1-1-etl.py # Python —Å–∫—Ä–∏–ø—Ç ETL –∑–∞–¥–∞—á–∏ 1.1
‚îÇ ‚îî‚îÄ‚îÄ presentation1-1.mp4 # –í–∏–¥–µ–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á–∏ 1.1
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 1.2
‚îÇ ‚îú‚îÄ‚îÄ 1-2.sql # SQL —Å–∫—Ä–∏–ø—Ç –∑–∞–¥–∞—á–∏ 1.2
‚îÇ ‚îî‚îÄ‚îÄ presentation1-2.mp4 # –í–∏–¥–µ–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á–∏ 1.2
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 1.3
‚îÇ ‚îú‚îÄ‚îÄ 1-3.sql # SQL —Å–∫—Ä–∏–ø—Ç –∑–∞–¥–∞—á–∏ 1.3
‚îÇ ‚îî‚îÄ‚îÄ presentation1-3.mp4 # –í–∏–¥–µ–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á–∏ 1.3
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 1.4
‚îÇ ‚îú‚îÄ‚îÄ 1-4.py # Python —Å–∫—Ä–∏–ø—Ç –∑–∞–¥–∞—á–∏ 1.4
‚îÇ ‚îî‚îÄ‚îÄ presentation1-3.mp4 # –í–∏–¥–µ–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á–∏ 1.4
‚îú‚îÄ‚îÄ docker-compose.yaml # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker –¥–ª—è PostgreSQL
‚îú‚îÄ‚îÄ sql.sql # –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º, —Ç–∞–±–ª–∏—Ü –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ë–î
‚îú‚îÄ‚îÄ .gitignore # –§–∞–π–ª –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è git
‚îî‚îÄ‚îÄ README.md # –≠—Ç–æ—Ç —Ñ–∞–π–ª
